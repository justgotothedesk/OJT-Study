# Thread 내에서의 다양한 변수 성능 비교
### 실험 목표: Thread 내에서 각 변수 간의 성능을 비교하며, 각 변수 유형이 어떻게 성능에 영향을 미치는지 이해할 수 있다.
### 변수 종류
- **Regular**: 일반 변수. 어떤 동기화 기법을 사용하지 않고 단순히 값을 증가시킨다.
- **TLS**: Thread마다 독립적인 변수를 사용하여 Race condition을 방지한다.
- **Spinlock**: Spinlock을 통해 변수 접근을 보호하여 Race condition을 방지한다.
- **Semaphore**: Semaphore를 통해 동시 접근을 제어한다.
- **Atomic**: Atomic한 연산을 통해서 변수 접근을 보호한다.

## 실험 결과 

### Thread #2

| Variable Type       | Execution Time (seconds) |
|---------------------|--------------------------|
| Regular Variable    | 0.003                    |
| TLS Variable        | 0.004                    |
| Spinlock Variable   | 0.165                    |
| Semaphore Variable  | 9.623                    |
| Atomic Variable     | 0.027                    |

### Thread #4

| Variable Type       | Execution Time (seconds) |
|---------------------|--------------------------|
| Regular Variable    | 0.008                    |
| TLS Variable        | 0.016                    |
| Spinlock Variable   | 0.504                    |
| Semaphore Variable  | 19.829                   |
| Atomic Variable     | 0.062                    |

### Thread #8

| Variable Type       | Execution Time (seconds) |
|---------------------|--------------------------|
| Regular Variable    | 0.015                    |
| TLS Variable        | 0.019                    |
| Spinlock Variable   | 1.367                    |
| Semaphore Variable  | 39.403                   |
| Atomic Variable     | 0.136                    |

## 결과 분석
- **Regular**: 속도가 제일 빠르다. 하지만, 동시성 문제로 인해서 Race condition이 발생하여 예상치 않은 값이 나올 수 있다.
- **TLS**: Thread마다 독립적인 변수를 가지므로, 동시성 문제가 발생하지 않는다. 속도가 느릴 것 같지만, 상당히 빠른 편이다. 속도의 경우, Lock이 큰 비중을 차지하는데, TLS는 변수는 각 Thread가 자신만의 복사본을 가지기에 Lock 없이 안전하게 사용할 수 있기 때문이다.
- **Spinlock**: Thread가 변수에 접근할 때, Lock을 사용하여 다른 Thread가 동일한 변수에 접근하지 못하게 한다. 따라서, Lock이 걸리는 동안 다른 Thread는 대기 상태에 있으므로 성능이 떨어진다. Thread가 많아질수록 대기하는 Thread의 수가 많아져 대기 시간 증가로 인해 속도가 떨어진다.
- **Semaphore**: Semaphore를 통해 한 번에 하나의 Thread만 변수에 접근할 수 있게 제어한다. Spinlock과 유사하지만, 그보다도 훨씬 속도가 느린 것을 확인할 수가 있다. 이는 Semaphore가 더 Spinlock에 비해 구현이 복잡하고 System call로 인한 overhead가 존재하기 때문이다.
- **Atomic**: Regular 변수에 비해서 성능이 약간 떨어지지만, 그럼에도 불구하고 높은 성능을 보여준다. Atomic 연산은 Lock과 같은 기능 없이도 안전하게 변수 접근을 보장하기 때문이다.

## 결론
- **TLS의 장점**: TLS를 사용하는 경우 Thread 간의 변수를 독립적으로 관리할 수 있어 성능과 안전성에서 큰 이점을 가진다.
- **동기화 기법**: Spinlock이나 Semaphore는 Thread 간 데이터 동기화를 보장하지만, Thread 수가 증가할수록 성능이 급격히 저하된다. Atomic 연산은 Race condition을 피하면서도 성능을 비교적 잘 유지한다.
- **적용 시나리오**: 각 기법은 특정한 시나리오에서 적합하다. 데이터 무결성이 중요한 경우 Atomic 연산이나 Lock이 유리하고, 독립적인 Thread 작업인 경우에는 TLS를 유리하다.